# ========================================
# QUICKCART ENVIRONMENT CONFIGURATION
# ========================================
# This template supports both DEVELOPMENT and PRODUCTION deployments
# Copy this file to .env and customize for your environment
#
# DEVELOPMENT: Use Docker Compose with local PostgreSQL & Redis
# PRODUCTION:  Use external PostgreSQL & Redis on separate VPS servers
#
# Required fields are marked with [REQUIRED]
# ========================================

# ========================================
# [REQUIRED] ENVIRONMENT
# ========================================
# Options: development, production
# - development: Enables debug mode, verbose logging
# - production:  Disables debug, optimized for performance
ENVIRONMENT=development

# Enable/disable debug mode
DEBUG=true

# Logging level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# ========================================
# [REQUIRED] TELEGRAM BOT
# ========================================
# Get your bot token from @BotFather on Telegram
# Example: 1234567890:ABCdefGHIjklMNOpqrSTUvwxYZ
TELEGRAM_BOT_TOKEN=your_bot_token_here

# Your Telegram User ID (get from @userinfobot)
# For multiple admins, separate with commas: 123456789,987654321
ADMIN_USER_IDS=123456789

# Optional: Welcome sticker file ID (send a sticker to your bot and check logs)
TELEGRAM_WELCOME_STICKER=

# ========================================
# [REQUIRED] PAYMENT GATEWAY (Pakasir)
# ========================================
# Get these from https://pakasir.com dashboard
PAKASIR_API_KEY=your_pakasir_api_key_here
PAKASIR_PROJECT_SLUG=your_project_slug

# Pakasir API base URL (default: https://app.pakasir.com)
PAKASIR_BASE_URL=https://app.pakasir.com

# Optional: Custom domain for payment pages
PAKASIR_PAYMENT_CUSTOM_DOMAIN=https://pots.my.id

# Optional: Webhook secret for verifying payment callbacks
PAKASIR_WEBHOOK_SECRET=

# ========================================
# [REQUIRED] SECURITY KEYS
# ========================================
# IMPORTANT: Generate strong random keys for production!
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"

# Secret key for session signing (minimum 32 characters)
SECRET_KEY=generate_a_random_secret_key_here_min_32_chars

# Encryption key for sensitive data (minimum 32 characters)
ENCRYPTION_KEY=generate_another_random_key_here_min_32_chars

# ========================================
# [REQUIRED] DATABASE CONFIGURATION
# ========================================
# Choose your deployment scenario:
#
# DEVELOPMENT (Docker Compose - local database):
#   DATABASE_URL=postgresql+asyncpg://quickcart:quickcart123@db:5432/quickcart
#   AUDIT_DATABASE_URL=postgresql+asyncpg://quickcart:quickcart123@db:5432/quickcart_audit
#
# PRODUCTION (External PostgreSQL VPS):
#   DATABASE_URL=postgresql+asyncpg://quickcart:SECURE_PASSWORD@192.168.1.100:5432/quickcart
#   AUDIT_DATABASE_URL=postgresql+asyncpg://quickcart:SECURE_PASSWORD@192.168.1.100:5432/quickcart_audit
#
# Format: postgresql+asyncpg://username:password@hostname:port/database

# Main database (operational data: users, products, orders)
DATABASE_URL=postgresql+asyncpg://quickcart:quickcart123@db:5432/quickcart

# Audit database (immutable logs: transactions, payments)
AUDIT_DATABASE_URL=postgresql+asyncpg://quickcart:quickcart123@db:5432/quickcart_audit

# Database connection pool settings
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# Audit database pool (usually smaller)
AUDIT_DB_POOL_SIZE=3
AUDIT_DB_MAX_OVERFLOW=10

# ========================================
# [OPTIONAL] REDIS CONFIGURATION
# ========================================
# Redis is OPTIONAL - the system works without it using in-memory storage
# Recommended for production to persist sessions across restarts
#
# DEVELOPMENT (Docker Compose - local Redis):
#   REDIS_URL=redis://:redis123@redis:6379/0
#
# PRODUCTION (External Redis VPS):
#   REDIS_URL=redis://:SECURE_PASSWORD@192.168.1.101:6379/0
#
# To disable Redis, leave empty or comment out:
#   REDIS_URL=
#
# Format: redis://[:password]@hostname:port/database

REDIS_URL=redis://:redis123@redis:6379/0

# ========================================
# [OPTIONAL] STORE SETTINGS
# ========================================
# Your store/business name
STORE_NAME=QuickCart Store

# Documentation URL (shown to users)
DOCUMENTATION_URL=https://notion.so/quickcart-docs

# Session timeout (seconds) - 24 hours
SESSION_TTL_SECONDS=86400

# ========================================
# [OPTIONAL] PAYMENT SETTINGS
# ========================================
# Payment processing fees (Pakasir default: 0.7% + Rp310)
PAYMENT_FEE_PERCENTAGE=0.007
PAYMENT_FEE_FIXED=310

# Payment expiry time (minutes)
PAYMENT_EXPIRY_MINUTES=10

# Voucher cooldown period (seconds) - 5 minutes
VOUCHER_COOLDOWN_SECONDS=300

# ========================================
# [OPTIONAL] MONITORING
# ========================================
# Sentry DSN for error tracking (leave empty to disable)
SENTRY_DSN=

# ========================================
# DEPLOYMENT INSTRUCTIONS
# ========================================
#
# DEVELOPMENT SETUP (Docker Compose - All-in-One):
# ------------------------------------------------
# 1. Copy this file: cp .env.template .env
# 2. Update REQUIRED fields (bot token, admin IDs, Pakasir credentials)
# 3. Generate security keys:
#    python -c "import secrets; print(secrets.token_urlsafe(32))"
# 4. Start services: docker-compose up -d
# 5. Run migrations: docker-compose exec app alembic upgrade head
# 6. View logs: docker-compose logs -f app
#
# PRODUCTION SETUP (External PostgreSQL + Redis VPS):
# ----------------------------------------------------
# 1. Set ENVIRONMENT=production and DEBUG=false
# 2. Update all [REQUIRED] fields with production values
# 3. Update DATABASE_URL with your PostgreSQL VPS IP/hostname
# 4. Update AUDIT_DATABASE_URL (can be same or different server)
# 5. Update REDIS_URL with your Redis VPS IP/hostname (or leave empty)
# 6. Use STRONG passwords for all services
# 7. Configure firewall rules (see docs/DEPLOYMENT_EXTERNAL_DB.md)
# 8. Use docker-compose.production.yml:
#    docker-compose -f docker-compose.production.yml up -d
#
# SECURITY BEST PRACTICES:
# ------------------------
# ✓ Use strong, unique passwords for production
# ✓ Rotate SECRET_KEY and ENCRYPTION_KEY regularly
# ✓ Restrict database access by IP whitelist
# ✓ Use private network between VPS servers
# ✓ Enable SSL/TLS for PostgreSQL connections
# ✓ Never commit .env file to version control
# ✓ Use environment-specific .env files (.env.dev, .env.prod)
#
# For detailed production deployment guide:
# → docs/DEPLOYMENT_EXTERNAL_DB.md
# → docs/deployment_quickref.md
#
# ========================================
