# ==============================================================================
# QuickCart Environment Configuration
# ==============================================================================
# Complete configuration template for local development and production deployment.
#
# SETUP INSTRUCTIONS:
# 1. Copy this file: cp .env.template .env
# 2. Fill in the REQUIRED variables (marked with *** REQUIRED ***)
# 3. Customize STORE SETTINGS to match your brand
# 4. For production: Update DATABASE and REDIS URLs to point to your servers
# 5. Review OPTIONAL settings and adjust as needed
#
# ==============================================================================

# ==============================================================================
# *** REQUIRED *** - MUST BE SET
# ==============================================================================

# --- Telegram Bot Configuration ---
# Get your bot token from @BotFather on Telegram
# Example: 1234567890:ABCdefGHIjklMNOpqrsTUVwxyz
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here

# Your Telegram User ID (comma-separated for multiple admins)
# Get your ID from @userinfobot on Telegram
# Example: 123456789,987654321
ADMIN_USER_IDS=your_telegram_user_id_here

# --- Pakasir Payment Gateway ---
# Get these from your Pakasir dashboard (https://app.pakasir.com)
PAKASIR_API_KEY=your_pakasir_api_key_here
PAKASIR_PROJECT_SLUG=your_pakasir_project_slug_here

# --- Security Keys ---
# Generate strong random strings (32+ characters)
# Linux/Mac: openssl rand -hex 32
# Python: python -c "import secrets; print(secrets.token_hex(32))"
SECRET_KEY=your_32_byte_secret_key_here
ENCRYPTION_KEY=your_32_byte_encryption_key_here

# ==============================================================================
# STORE CUSTOMIZATION - Make it your own!
# ==============================================================================

# Your store name (shown in all bot messages)
# Example: "Toko Digital Saya", "Premium Store", "Akun Murah"
STORE_NAME="QuickCart Store"

# Bot name (shown in help and version commands)
# Example: "MyStore Bot", "Digital Shop Bot"
BOT_NAME="QuickCart Bot"

# Bot username (optional, for display purposes)
# Example: "@MyStoreBot"
BOT_USERNAME=

# Documentation URL for your store
# Where customers can read detailed guides
# Example: "https://notion.so/mystore-docs" or "https://t.me/YourChannel"
DOCUMENTATION_URL="https://notion.so/quickcart-docs"

# Support contact (optional)
# Where customers can get help
# Example: "@YourSupportUsername", "+628123456789", "https://wa.me/628123456789"
SUPPORT_CONTACT=

# Welcome sticker file ID (optional)
# Send a sticker to @userinfobot to get its file_id
# Leave as default or change to your own sticker
TELEGRAM_WELCOME_STICKER="CAACAgIAAxkBAAIDbWkLZHuqPRCqCqmL9flozT9YJdWOAAIZUAAC4KOCB7lIn3OKexieNgQ"

# ==============================================================================
# DATABASE CONFIGURATION
# ==============================================================================
#
# FOR LOCAL DEVELOPMENT (Docker Compose):
# Use the service names: db:5432 and audit_db:5432
#
# FOR PRODUCTION (External PostgreSQL Server):
# Replace with your actual PostgreSQL server IP/hostname
# Format: postgresql+asyncpg://user:password@host:port/database
# Example: postgresql+asyncpg://quickcart:secretpass@192.168.1.100:5432/quickcart
#
# TIP: You can use the same PostgreSQL server for both databases
# ==============================================================================

# --- Main Database (Operational Data) ---
# Local development:
DATABASE_URL=postgresql+asyncpg://quickcart:quickcart@db:5432/quickcart
# Production example (uncomment and modify):
# DATABASE_URL=postgresql+asyncpg://quickcart:YOUR_STRONG_PASSWORD@your-db-server.com:5432/quickcart

# --- Audit Database (Compliance Logs) ---
# Local development:
AUDIT_DATABASE_URL=postgresql+asyncpg://quickcart_audit:quickcart_audit@audit_db:5432/quickcart_audit
# Production example (uncomment and modify):
# AUDIT_DATABASE_URL=postgresql+asyncpg://quickcart_audit:YOUR_STRONG_PASSWORD@your-db-server.com:5432/quickcart_audit

# --- Database Credentials (for init scripts) ---
# Only needed if using Docker Compose or manual database setup
POSTGRES_USER=quickcart
POSTGRES_PASSWORD=quickcart
POSTGRES_DB=quickcart
AUDIT_POSTGRES_USER=quickcart_audit
AUDIT_POSTGRES_PASSWORD=quickcart_audit
AUDIT_POSTGRES_DB=quickcart_audit

# --- Database Connection Pool ---
# Adjust for production load
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600
AUDIT_DB_POOL_SIZE=2
AUDIT_DB_MAX_OVERFLOW=5

# ==============================================================================
# REDIS CONFIGURATION (OPTIONAL)
# ==============================================================================
#
# Redis is OPTIONAL - the bot works without it using in-memory fallback.
# For production with multiple bot instances, Redis is RECOMMENDED.
#
# FOR LOCAL DEVELOPMENT (Docker Compose):
# Use the service name: redis:6379
#
# FOR PRODUCTION (External Redis Server):
# Replace with your actual Redis server IP/hostname
# Format: redis://[:password@]host:port/db
# Example: redis://:yourpassword@192.168.1.200:6379/0
#
# TO DISABLE REDIS: Leave empty or comment out
# ==============================================================================

# Local development:
REDIS_URL=redis://redis:6379/0
# Production example (uncomment and modify):
# REDIS_URL=redis://:YOUR_REDIS_PASSWORD@your-redis-server.com:6379/0
# To disable Redis (use in-memory fallback):
# REDIS_URL=

# Session TTL in seconds (24 hours = 86400)
SESSION_TTL_SECONDS=86400

# ==============================================================================
# ENVIRONMENT SETTINGS
# ==============================================================================

# Environment: development or production
# In production, set this to "production" for optimized logging and behavior
ENVIRONMENT=development

# Enable debug mode (verbose logging)
# Set to False in production for better performance
DEBUG=True

# Logging level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# ==============================================================================
# PAYMENT CONFIGURATION
# ==============================================================================

# Pakasir API base URL (usually no need to change)
PAKASIR_BASE_URL=https://app.pakasir.com

# Custom payment domain (for branded checkout pages)
PAKASIR_PAYMENT_CUSTOM_DOMAIN=https://pots.my.id

# Webhook signature secret (HIGHLY RECOMMENDED for production)
# Get this from Pakasir dashboard under webhook settings
# Leave empty for development/testing
PAKASIR_WEBHOOK_SECRET=

# Payment fee calculation: (subtotal * percentage) + fixed_fee
# Default: 0.7% + Rp310 (as per Indonesian payment gateway standards)
PAYMENT_FEE_PERCENTAGE=0.007
PAYMENT_FEE_FIXED=310

# Payment expiry time in minutes
# User must complete payment within this time
PAYMENT_EXPIRY_MINUTES=10

# ==============================================================================
# BUSINESS LOGIC SETTINGS
# ==============================================================================

# Voucher usage cooldown in seconds (5 minutes = 300)
# Prevents voucher spam
VOUCHER_COOLDOWN_SECONDS=300

# Refund calculation multipliers
# Based on time since purchase and claim history
REFUND_MULTIPLIER_UNDER_7_DAYS=0.8
REFUND_MULTIPLIER_7_PLUS_DAYS=0.7
REFUND_MULTIPLIER_1_2_CLAIMS=0.6
REFUND_MULTIPLIER_3_CLAIMS=0.5
REFUND_MULTIPLIER_OVER_3_CLAIMS=0.4

# ==============================================================================
# EXTERNAL SERVICES (OPTIONAL)
# ==============================================================================

# Sentry DSN for error tracking and monitoring (production recommended)
# Get this from https://sentry.io after creating a project
# Leave empty to disable Sentry
SENTRY_DSN=

# ==============================================================================
# PRODUCTION DEPLOYMENT CHECKLIST
# ==============================================================================
#
# Before deploying to production, ensure:
#
# [ ] Changed ENVIRONMENT=production
# [ ] Set DEBUG=False
# [ ] Set strong SECRET_KEY and ENCRYPTION_KEY (32+ chars)
# [ ] Updated DATABASE_URL to external PostgreSQL server
# [ ] Updated AUDIT_DATABASE_URL to external PostgreSQL server
# [ ] Updated REDIS_URL to external Redis server (or disabled)
# [ ] Set PAKASIR_WEBHOOK_SECRET for security
# [ ] Customized STORE_NAME, BOT_NAME to your brand
# [ ] Set DOCUMENTATION_URL to your actual docs
# [ ] Verified ADMIN_USER_IDS are correct
# [ ] Tested bot with /start command
# [ ] Checked database migrations run successfully
# [ ] Verified Redis connection (if enabled)
# [ ] Configured firewall rules for database/redis access
# [ ] Set up SSL/TLS for database connections (recommended)
# [ ] Configured backup strategy for databases
# [ ] Set up monitoring/alerting (Sentry or similar)
#
# ==============================================================================

# ==============================================================================
# NOTES
# ==============================================================================
#
# 1. NEVER commit .env file to git (it's in .gitignore)
# 2. Keep production .env file secure and backed up
# 3. Use different passwords for development and production
# 4. For production, consider using secrets management (e.g., Docker secrets, Vault)
# 5. Database and Redis servers should be on private network or use SSL/TLS
# 6. Change default passwords immediately in production
# 7. Keep this template updated when adding new configuration options
#
# ==============================================================================

# ==============================================================================
# QUICK START EXAMPLES
# ==============================================================================
#
# EXAMPLE 1: Local Development with Docker Compose
# -------------------------------------------------
# TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHI...
# ADMIN_USER_IDS=123456789
# PAKASIR_API_KEY=pk_test_...
# PAKASIR_PROJECT_SLUG=my-test-store
# SECRET_KEY=dev_secret_key_32_chars_minimum
# ENCRYPTION_KEY=dev_encryption_32_chars_minimum
# STORE_NAME="My Test Store"
# DATABASE_URL=postgresql+asyncpg://quickcart:quickcart@db:5432/quickcart
# AUDIT_DATABASE_URL=postgresql+asyncpg://quickcart_audit:quickcart_audit@audit_db:5432/quickcart_audit
# REDIS_URL=redis://redis:6379/0
# ENVIRONMENT=development
# DEBUG=True
#
# EXAMPLE 2: Production with External Servers
# --------------------------------------------
# TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHI...
# ADMIN_USER_IDS=123456789,987654321
# PAKASIR_API_KEY=pk_live_...
# PAKASIR_PROJECT_SLUG=my-production-store
# SECRET_KEY=<generated with: openssl rand -hex 32>
# ENCRYPTION_KEY=<generated with: openssl rand -hex 32>
# STORE_NAME="Premium Digital Store"
# BOT_NAME="Premium Store Bot"
# DOCUMENTATION_URL="https://docs.mystore.com"
# SUPPORT_CONTACT="@MyStoreSupport"
# DATABASE_URL=postgresql+asyncpg://quickcart:STRONG_PASS@db.myserver.com:5432/quickcart
# AUDIT_DATABASE_URL=postgresql+asyncpg://quickcart_audit:STRONG_PASS@db.myserver.com:5432/quickcart_audit
# REDIS_URL=redis://:REDIS_PASS@cache.myserver.com:6379/0
# PAKASIR_WEBHOOK_SECRET=<from Pakasir dashboard>
# ENVIRONMENT=production
# DEBUG=False
# LOG_LEVEL=WARNING
# SENTRY_DSN=https://...@sentry.io/...
#
# ==============================================================================
